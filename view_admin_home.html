<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <?!= HtmlService.createHtmlOutputFromFile('css').getContent(); ?>
    <style>
      /* èƒŒæ™¯ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
      #overlay {
        display:none;
        position:fixed; top:0; left:0;
        width:100%; height:100%;
        background:rgba(0,0,0,.3);
        z-index:999;
      }

      /* ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›ãƒ¢ãƒ¼ãƒ€ãƒ« */
      .pw-box {
        position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
        background:#fff; padding:24px;
        border:1px solid #ccc; border-radius:12px;
        box-shadow:0 6px 18px rgba(0,0,0,.25);
        width:340px;
        z-index:1000;
        text-align:center; /* ä¸­å¤®å¯„ã› */
      }

      .pw-box h2 {
        margin:0 0 10px;
        font-size:20px;
      }

      .pw-box p {
        font-size:14px;
        color:#555;
        margin:0 0 14px;
      }

      .pw-box input[type="password"] {
        width:80%;
        padding:10px;
        font-size:16px;
        margin:0 auto 14px;
        border:1px solid #ccc;
        border-radius:6px;
        display:block;
        text-align:center; /* å…¥åŠ›æ–‡å­—ã‚‚ä¸­å¤®å¯„ã› */
      }

      #pwError {
        color:red;
        font-size:13px;
        margin-bottom:10px;
        text-align:center;
      }

      .btn-row {
        display:flex;
        justify-content:center;
        gap:12px;
      }

      .btn-cancel, .btn-ok {
        flex:1;
        max-width:120px;
        text-align:center;
        padding:10px 0;
        font-size:15px;
        border:none;
        border-radius:6px;
        cursor:pointer;
      }

      .btn-cancel {
        background:#ccc;
        color:#333;
        text-decoration:none; /* <a>ç”¨ */
        display:inline-block;
      }
      .btn-ok {
        background:#2d87ff;
        color:#fff;
      }

      .btn-cancel:hover { background:#bbb; }
      .btn-ok:hover { background:#1c5fc9; }
    </style>
    <script>
      // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª
      function confirmAdminPw(){
        var pw = document.getElementById("adminPw").value;
        document.getElementById("pwError").textContent = "ç¢ºèªä¸­â€¦";

        google.script.run
          .withSuccessHandler(function(msg){
            if (msg === "OK") {
              hidePwBox();
              document.getElementById("adminContent").style.display = "block";
            } else {
              document.getElementById("pwError").textContent = "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™";
            }
          })
          .withFailureHandler(function(err){
            document.getElementById("pwError").textContent = err.message || "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ";
          })
          .checkAdminPassword(pw);
      }

      function hidePwBox(){
        document.getElementById("pwBox").style.display = "none";
        document.getElementById("overlay").style.display = "none";
      }

      function showPwBox(){
        document.getElementById("pwBox").style.display = "block";
        document.getElementById("overlay").style.display = "block";
      }

      document.addEventListener("DOMContentLoaded", function(){
        var fromParam = "<?= from ?>"; // GASã‹ã‚‰åŸ‹ã‚è¾¼ã¿
        if (fromParam === "home") {
          showPwBox();
        } else {
          document.getElementById("adminContent").style.display = "block";
        }
      });
    </script>
  </head>
  <body>
    <div class="company-title">é–‹ç™ºå¡¾ - å¡¾é•·ãƒšãƒ¼ã‚¸</div>

    <!-- èƒŒæ™¯ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
    <div id="overlay"></div>

    <!-- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="pwBox" class="pw-box" style="display:none;">
      <h2>ğŸ”‘ ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³</h2>
      <p>ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
      
      <input type="password" id="adminPw" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
      <div id="pwError"></div>

      <div class="btn-row">
        <a href="<?= getAppUrl() ?>" class="btn-cancel">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</a>
        <button class="btn-ok" onclick="confirmAdminPw()">OK</button>
      </div>
    </div>

    <!-- èªè¨¼å¾Œã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div id="adminContent" style="display:none;">
      <div class="emp-list">
        <h3>ãƒšãƒ¼ã‚¸é¸æŠ</h3>
        <div class="emp-card-wrap">
          <a class="emp-card" href="<?= getAppUrl() ?>?page=admin_salary">
            <span class="emp-id">çµ¦ä¸</span>
            <span class="emp-name">çµ¦ä¸è¨ˆç®—ãƒšãƒ¼ã‚¸</span>
          </a>
          <a class="emp-card" href="<?= getAppUrl() ?>?page=admin_analysis">
            <span class="emp-id">åˆ†æ</span>
            <span class="emp-name">æˆæ¥­åˆ†æãƒšãƒ¼ã‚¸</span>
          </a>
          <a class="emp-card" href="<?= getAppUrl() ?>?page=admin_attendance">
            <span class="emp-id">å‹¤å‹™</span>
            <span class="emp-name">å‹¤å‹™çŠ¶æ³ãƒšãƒ¼ã‚¸</span>
          </a>
        </div>
      </div>
      <div class="btn-frame" style="margin-top:16px;">
        <a href="<?= getAppUrl() ?>">ãƒ›ãƒ¼ãƒ ç”»é¢ã«æˆ»ã‚‹</a>
      </div>
    </div>
  </body>
</html>
